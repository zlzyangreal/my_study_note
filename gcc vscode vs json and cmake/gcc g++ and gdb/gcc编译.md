# gcc编译

编译过程
--------
1.预处理    //.i文件
```
gcc -E hello.c -o hello.i
```
~~~
.i文件

预处理后文件，预处理器执行宏替换、条件编译以及包含指定的文件
~~~

2.编译      //.s文件
```
gcc -S hello.c -o hello.s
```
~~~
汇编文件，由预处理得到的源代码文件，进行机器翻译产出。老程序员前辈们前大多都会学习汇编语言，但汇编语言写的源程序一般为大写的 .S 文件后缀，而且会进行预处理、汇编等操作，而小写 .s文件后期阶段不再进行预处理操作，所以不在内写预处理语句。厂家提供的库中通常都会有一个 *.s文件 如startup_stm32f10x_cl.s
~~~

3.汇编      //.o文件
```
gcc -c hello.s -o hello.o
```
~~~
可重定位目标文件（机器码文件），由汇编文件经过汇编操作生成，该文件不可直接执行
~~~

4.链接      //bin文件
```
gcc -o hello.o -o hello
```
~~~
二进制可执行目标文件（也是一个目标文件），由机器码文件进一步链接生成。这一步中，各种符号引用和符号定义转换成为可执行文件中的合适信息，通常是虚拟地址
~~~

**4个步骤也可直接一步生成**
```
gcc hello.c -o hello
```

* *.elf 文件：Executable and Linkable Format，可执行连接格式。在Unix和X86-64 Linux上目标文件也被称为ELF文件，即上文中提到的可重定向目标文件、可执行目标文件、共享目标文件（库文件）都可以被称为ELF文件


g++编译参数选项
-----------
***-o参数***

-o 编译选项来为将产生的可执行文件用指定的文件名

***调试选项-g***

-g 选项告诉 GCC 产生能被 GNU 调试器使用的调试信息以便调试你的程序。产生调试信息的可执行文件test。`g++ -g test.cpp -o test`

***-O参数***

-O 选项告诉 GCC 对源代码进行基本优化。这些优化在大多数情况下都会使程序执行的更快。-O 主要进行跳转和延迟退栈两种优化；
* -O0 表示不做优化
* -O1 为默认优化
* -O2 除了完成-O1的优化之外，还进行一些额外的调整工作，如指令调整等
* -O3 则包括循环展开和其他一些与处理特性相关的优化工作

**可使用`time`查询运行时间

***-l参数和-L参数***

-l参数就是用来指定程序要链接的库，-l参数紧接着就是库名，-L参数跟着的是库文件所在的目录名
~~~
例子：
    链接glog库

    g++ -lglog test.cpp

    但是库如果找不到

    g++ -L/home/zlzyang/Desktop/leran | -lglog test.cpp
~~~

***-I参数***

-I参数可以用相对路径，比如头文件在当前 目录，可以用-I来指定

***-Wall、-w 和 -v参数***

* -Wall 打印出gcc提供的警告信息

* -w     关闭所有警告信息

* -v      列出所有编译步骤

***编译标准 -std***

使用c++11标准
`g++ -std=c++11 test.cpp`

***-D参数***

定义一个宏定义